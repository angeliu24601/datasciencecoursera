{
    "collab_server" : "",
    "contents" : "#Download and upzip the data into the subfolder under the R working directory\n#the method = \"curl\" for download.file on Mac os\nURL <- \"https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip\"\ntemp <- tempfile()\ndownload.file(URL,temp, method = \"curl\")\nunzip (temp,exdir = \"./exploratory-analysis_project2\")\nrm(URL,temp)\nlibrary(dplyr)\nlibrary(ggplot2)\n#Read the files from the subfolder under the working directory into R\nNEI <- readRDS(\"./exploratory-analysis_project2/summarySCC_PM25.rds\")\nSCC <- readRDS(\"./exploratory-analysis_project2/Source_Classification_Code.rds\")\n\n####Plot1####\n#1 Have total emissions from PM2.5 decreased in the United States from 1999 to 2008?\n#Using the base plotting system, make a plot showing the total PM2.5 emission from\n#all sources for each of the years 1999, 2002, 2005, and 2008.\n##Summarize the data by sum of each year using the \"dplyr\"\nNEI.yearsum <- NEI %>% group_by(year) %>% summarize(sum(Emissions))\ncolnames(NEI.yearsum) <- c(\"year\",\"sum_emissions\")\nNEI.yearsum$year <- as.factor(NEI.yearsum$year)\n##Plot the total emissions by year\npng(\"./exploratory-analysis_project2/plot1.png\")\npl1 <- with(NEI.yearsum, \n            barplot(sum_emissions, main = \"Emissions by year in US\",\n                    xlab = \"year\", ylab = \"emissions\"))\naxis(1, at = pl1, labels = NEI.yearsum$year)\ndev.off()\n##Based on the plot, the total emissions did go down from 1999 to 2008\n\n####Plot2####\n#2 Have total emissions from PM2.5 decreased in the Baltimore City, Maryland (fips == \"24510\")\n#from 1999 to 2008? Use the base plotting system to make a plot answering this question.\n##Subset the data for Baltimore City, Maryland\nNEI.BC.year.sum <- NEI %>% filter(fips == \"24510\") %>% group_by(year) %>%\n  summarize(sum(Emissions))\ncolnames(NEI.BC.year.sum) <- c(\"year\",\"sum_emissions\")\nNEI.BC.year.sum$year <- as.factor(NEI.BC.year.sum$year)\n##Plot the total emission in Baltimore City\npng(\"./exploratory-analysis_project2/plot2.png\")\npl2 <- with(NEI.BC.year.sum, \n            barplot(sum_emissions, main = \"Emissions by year in Baltimore City\",\n                    xlab = \"year\", ylab = \"emissions\"))\naxis(1, at = pl2, labels = NEI.BC.year.sum$year)\ndev.off()\n##Based on the plot, in general the total emissions went down from 1999 to 2008,\n##with the exception of 2005, which is higher than 2002\n\n####Plot3####\n#3 Of the four types of sources indicated by the type (point, nonpoint, onroad, nonroad) variable,\n#which of these four sources have seen decreases in emissions from 1999–2008 for Baltimore City?\n#Which have seen increases in emissions from 1999–2008?\n#Use the ggplot2 plotting system to make a plot answer this question.\n\n##Subset the data for Baltimore City, Maryland\nNEI.BC.year.sum.type <- NEI %>% filter(fips == \"24510\") %>% group_by(year,type) %>% \n  summarize(sum(Emissions))\ncolnames(NEI.BC.year.sum.type) <- c(\"year\", \"type\",\"sum_emissions\")\n##Plot the total emissions by year within each type\npng(\"./exploratory-analysis_project2/plot3.png\")\npl3 <- ggplot(NEI.BC.year.sum.type, aes(x = year, y = sum_emissions)) + \n  geom_point(shape = 1) + facet_wrap (~ type, ncol = 2)\npl3\ndev.off()\n##Based on the plot, the source \"POINT\" has seen increases in emissions while the rest have seen decreases\n\n####Plot4####\n#4 Across the United States, how have emissions from coal combustion-related sources changed?\n\n##Find coal combustion-related sources:in SCC.Level.One contains \"combustion\"\n##and in SCC.Level.Three contains \"coal\"\nSCC_CoalCombustion <- SCC[grepl(\"[Cc]ombustion\",SCC$SCC.Level.One) ==TRUE & grepl(\"[Cc]oal\",SCC$SCC.Level.Three)==TRUE,]\n##Filter in  NEI the emissions related to coal combustion\nNEI_CoalCombustion <- filter(NEI,SCC %in% SCC_CoalCombustion$SCC)\nNEI_CoalCombustion$year <- as.factor(NEI_CoalCombustion$year)\n##Plot the sum of emissions by year\npng(\"./exploratory-analysis_project2/plot4.png\")\nggplot(NEI_CoalCombustion,aes(x=year, y = Emissions)) + \n  stat_summary(fun.y = sum,geom=\"bar\") + \n  ylab(\"emissions from coal combustion-related sources\")\ndev.off()\n##Based on the plot, emissions from coal combustion-related sources decreased across the US\n\n####Plot5####\n#5 How have emissions from motor vehicle sources changed from 1999–2008 in Baltimore City?\n\n##Find motor vehicle sources of emissions by searching \"[Vv]ehicle\" or \"[Ee]ngine\" in SCC.Level.Two\nSCC_MV <- SCC[grepl(\"[Vv]ehicle\",SCC$SCC.Level.Two) ==TRUE | grepl(\"[Ee]nginel\",SCC$SCC.Level.Two)==TRUE,]\n##Subset the data for Baltimore City, Maryland and filter\n##the emissions related to motor vehicle\nNEI.BC.MV <- NEI %>% filter(fips == \"24510\") %>% filter(SCC %in% SCC_MV$SCC)\nNEI.BC.MV$year <- as.factor(NEI.BC.MV$year)\n##Plot the sum of emissions by year\npng(\"./exploratory-analysis_project2/plot5.png\")\nggplot(NEI.BC.MV,aes(x=year, y = Emissions)) + \n  stat_summary(fun.y = sum,geom=\"bar\") +\n  ylab(\"emissions from motor vehicle sources\")\ndev.off()\n##Based on the plot, emissions from motor vehicle sources decreased in Baltimore City from 1999-2008\n\n####Plot6####\n##6 Compare emissions from motor vehicle sources in Baltimore City with emissions\n#from motor vehicle sources in Los Angeles County, California (fips == \"06037\").\n#Which city has seen greater changes over time in motor vehicle emissions?\n\n##Find motor vehicle related sources of emissions by searching \"[Vv]ehicle\" or \"[Ee]ngine\" in SCC.Level.Two\nSCC_MV <- SCC[grepl(\"[Vv]ehicle\",SCC$SCC.Level.Two) ==TRUE | grepl(\"[Ee]nginel\",SCC$SCC.Level.Two)==TRUE,]\n\n##Subset the emissions from Baltimore City and Los Angeles County and filer \n##the emissions related to motor vehicle\nNEI.BC.LA.MV <- NEI %>% filter(fips == \"06037\" | fips == \"24510\") %>%\n  filter(SCC %in% SCC_MV$SCC) %>% \n  mutate(county = ifelse(fips == \"06037\", \"LA County\", \"Baltimore City\"))\nNEI.BC.LA.MV$year <- as.factor(NEI.BC.LA.MV$year)\n##Plot the comparison of the two\npng(\"./exploratory-analysis_project2/plot6.png\")\nggplot(NEI.BC.LA.MV,aes(x=year, y = Emissions)) + \n  stat_summary(fun.y = sum, geom=\"bar\") + facet_grid(.~ county) +\n  ylab(\"emissions from motor vehicle sources\") \ndev.off()\n##Based on the plot, Los Angeles has seen greater changes over time",
    "created" : 1463943853276.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "13|9|28|70|\n48|9|64|106|\n66|9|81|91|\n83|9|98|100|\n100|9|120|67|\n",
    "hash" : "2352375687",
    "id" : "2B82A51D",
    "lastKnownWriteTime" : 1463967549,
    "last_content_update" : 1463967741597,
    "path" : "~/Downloads/OneDrive - Inter-American Development Bank Group/ForMe/Coursera_DataScience/04_Exploratory-data-analysis/assignments/exploratory-analysis_project2/project2.R",
    "project_path" : "exploratory-analysis_project2/project2.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}